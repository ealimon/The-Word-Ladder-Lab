<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word Ladder Lab: Master Edition</title>
    <style>
        /* ========================================
           COLOR THEMES 
           ========================================
        */
        :root {
            --lvl1-accent: #00d4ff; /* Cyan - Junior */
            --lvl2-accent: #a855f7; /* Purple - Senior */
            --lvl3-accent: #f59e0b; /* Orange - Master */
            
            --bg-dark: #0f172a;
            --panel-bg: #1e293b;
            --text-light: #ffffff;
            --success-green: #22c55e;
            --error-red: #ef4444;
            --hint-gold: #fbbf24;
            
            /* This variable updates via JavaScript when leveling up */
            --current-accent: var(--lvl1-accent);
        }

        /* ========================================
           LAYOUT STYLES 
           ========================================
        */
        body {
            font-family: 'Courier New', monospace;
            background-color: var(--bg-dark);
            color: var(--text-light);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow-x: hidden;
        }

        .lab-container {
            width: 95%;
            max-width: 550px;
            background: var(--panel-bg);
            padding: 2.5rem;
            border: 4px solid var(--current-accent);
            border-radius: 24px;
            text-align: center;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
            transition: border-color 0.8s ease;
        }

        .lvl-tag {
            font-size: 0.9rem;
            font-weight: bold;
            color: var(--current-accent);
            letter-spacing: 3px;
            text-transform: uppercase;
            margin-bottom: 5px;
            transition: color 0.8s ease;
        }

        h1 {
            margin: 10px 0;
            font-size: 1.8rem;
        }

        /* ========================================
           LADDER VISUALS 
           ========================================
        */
        #ladder {
            display: flex;
            flex-direction: column-reverse; 
            gap: 12px;
            margin: 25px auto;
            padding: 15px;
            border-left: 12px solid #475569;
            border-right: 12px solid #475569;
            width: fit-content;
            min-width: 280px;
            background: rgba(15, 23, 42, 0.5);
            border-radius: 4px;
        }

        .rung {
            background: #2d3748;
            padding: 14px;
            border-radius: 8px;
            font-size: 2.2rem;
            font-weight: bold;
            letter-spacing: 10px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .rung.solved {
            color: var(--text-light);
            opacity: 0.7;
            background: transparent;
        }

        .rung.target { 
            border-color: var(--current-accent); 
            color: var(--current-accent); 
            background: var(--bg-dark);
            box-shadow: inset 0 0 10px rgba(0,0,0,0.5);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        .rung.locked {
            color: #475569;
            letter-spacing: 10px;
        }

        /* ========================================
           INTERFACE ELEMENTS 
           ========================================
        */
        .hint-text {
            color: var(--hint-gold);
            font-weight: bold;
            margin: 20px 0;
            min-height: 3.5em;
            font-size: 1.1rem;
            line-height: 1.4;
        }

        .msg-text {
            height: 30px;
            margin-bottom: 15px;
            font-weight: bold;
            font-size: 1.3rem;
        }

        .keyboard {
            display: grid;
            grid-template-columns: repeat(9, 1fr);
            gap: 6px;
            margin-top: 15px;
        }

        .key {
            padding: 15px 5px;
            background: var(--current-accent);
            border: none;
            border-radius: 6px;
            font-weight: bold;
            font-family: inherit;
            cursor: pointer;
            color: var(--bg-dark);
            font-size: 1.1rem;
            transition: all 0.2s;
        }

        .key:active { transform: translateY(3px); }

        .key:disabled {
            background: #334155;
            cursor: not-allowed;
            opacity: 0.3;
        }

        .btn-action {
            display: none;
            margin-top: 25px;
            padding: 18px 40px;
            background: var(--success-green);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.3rem;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(34, 197, 94, 0.4);
        }

        #final-screen { display: none; }
        .badge-icon { font-size: 6rem; margin: 25px 0; }

    </style>
</head>
<body>

<div class="lab-container" id="game-screen">
    <div id="level-display" class="lvl-tag">LEVEL 1: JUNIOR ASSISTANT</div>
    <h1 id="lab-title">üß™ Experiment 1/3</h1>
    
    <div id="ladder">
        </div>

    <div id="message" class="msg-text"></div>
    <div id="hint" class="hint-text"></div>
    
    <div id="keyboard" class="keyboard">
        </div>

    <button id="nextBtn" class="btn-action" onclick="handleNext()">NEXT EXPERIMENT ‚ûî</button>
</div>

<div class="lab-container" id="final-screen">
    <div class="lvl-tag" style="color: var(--lvl3-accent)">RANK: MASTER SCIENTIST</div>
    <h1>üèÜ MISSION COMPLETE</h1>
    <div class="badge-icon">üë®‚Äçüî¨</div>
    <h2>Expert Scientist Certified!</h2>
    <p>You have successfully completed all 9 Word Ladder Labs with perfect logic.</p>
    <button class="btn-action" style="display:inline-block; background: var(--lvl1-accent);" onclick="location.reload()">RESTART ALL LABS</button>
</div>

<script>
    /* ========================================
       DATA MODELS
       ========================================
    */
    const levels = [
        {
            name: "LEVEL 1: JUNIOR ASSISTANT",
            color: "#00d4ff",
            ladders: [
                [
                    {w:"CAT", h:"Start: A common household pet"},
                    {w:"HAT", h:"Change one sound: You wear this on your head"},
                    {w:"HOT", h:"Change one sound: The sun feels like this"},
                    {w:"POT", h:"Change one sound: Used for cooking soup"},
                    {w:"DOT", h:"Change one sound: A tiny round circle"}
                ],
                [
                    {w:"FIN", h:"Start: A fish uses this to swim"},
                    {w:"PIN", h:"Change one sound: A sharp metal object"},
                    {w:"PAN", h:"Change one sound: You fry eggs in this"},
                    {w:"MAN", h:"Change one sound: An adult male"},
                    {w:"FAN", h:"Change one sound: Blows cool air"}
                ],
                [
                    {w:"MUG", h:"Start: A large cup for cocoa"},
                    {w:"BUG", h:"Change one sound: A tiny crawling insect"},
                    {w:"BAG", h:"Change one sound: Used to carry things"},
                    {w:"RAG", h:"Change one sound: Used for cleaning spills"},
                    {w:"RAT", h:"Change one sound: A large rodent"}
                ]
            ]
        },
        {
            name: "LEVEL 2: SENIOR RESEARCHER",
            color: "#a855f7",
            ladders: [
                [
                    {w:"SHIP", h:"Start: A large boat on the ocean"},
                    {w:"SHOP", h:"Change one sound: To buy things at a store"},
                    {w:"CHOP", h:"Change one sound: To cut with an axe"},
                    {w:"CHIP", h:"Change one sound: A small piece of a potato"},
                    {w:"CLIP", h:"Change one sound: Used to hold papers together"}
                ],
                [
                    {w:"FAST", h:"Start: Moving with great speed"},
                    {w:"LAST", h:"Change one sound: The opposite of first"},
                    {w:"LIST", h:"Change one sound: A set of written items"},
                    {w:"FIST", h:"Change one sound: A hand closed tight"},
                    {w:"FISH", h:"Change one sound: An animal with gills"}
                ],
                [
                    {w:"GRAB", h:"Start: To take something suddenly"},
                    {w:"GRAM", h:"Change one sound: A small unit of weight"},
                    {w:"TRAM", h:"Change one sound: An electric streetcar"},
                    {w:"TRAP", h:"Change one sound: Used to catch something"},
                    {w:"TRIP", h:"Change one sound: To stumble or a vacation"}
                ]
            ]
        },
        {
            name: "LEVEL 3: MASTER SCIENTIST",
            color: "#f59e0b",
            ladders: [
                [
                    {w:"CLOCK", h:"Start: It tells you the time"},
                    {w:"BLOCK", h:"Change one sound: A toy cube or city square"},
                    {w:"BLACK", h:"Change one sound: The darkest color"},
                    {w:"SLACK", h:"Change one sound: Not tight or loose"},
                    {w:"STACK", h:"Change one sound: A neat pile of things"}
                ],
                [
                    {w:"STAMP", h:"Start: Put this on a letter"},
                    {w:"STUMP", h:"Change one sound: Bottom of a cut tree"},
                    {w:"SLUMP", h:"Change one sound: To sit or stand lazily"},
                    {w:"CLUMP", h:"Change one sound: A small group or cluster"},
                    {w:"CLAMP", h:"Change one sound: A tool to hold things tight"}
                ],
                [
                    {w:"SHIRT", h:"Start: Clothing for your upper body"},
                    {w:"SHORT", h:"Change one sound: The opposite of tall"},
                    {w:"SHORE", h:"Change one sound: Where the land meets the sea"},
                    {w:"SHARE", h:"Change one sound: To give some to a friend"},
                    {w:"SHAPE", h:"Change one sound: A circle, square, or triangle"}
                ]
            ]
        }
    ];

    /* ========================================
       GAME STATE
       ========================================
    */
    let currentLvlIdx = 0;
    let currentLabIdx = 0;
    let stepIdx = 1;

    /* ========================================
       CORE FUNCTIONS
       ========================================
    */
    function initGame() {
        const lvl = levels[currentLvlIdx];
        
        // Update UI colors and text
        document.documentElement.style.setProperty('--current-accent', lvl.color);
        document.getElementById('level-display').innerText = lvl.name;
        document.getElementById('lab-title').innerText = `üß™ Experiment ${currentLabIdx + 1}/3`;
        
        // Build Keyboard
        const kb = document.getElementById('keyboard');
        kb.innerHTML = '';
        "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("").
